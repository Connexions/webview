<script>
var loaded = 0;

function show() {
  var x = document.URL;
  if(loaded == 0){
    document.getElementById("preferences-options").value = localStorage.getItem(x);
    loaded = 1;
  }
  if(document.getElementById("preferences-options").style.display == "none"){
    document.getElementById("preferences-options").style.display ="";
  }
  else{
    document.getElementById("preferences-options").style.display ="none";
   }
}


function contrast_black_white() {
  var paragraphs = document.getElementsByTagName("p");
  for(var i = 0; i < paragraphs.length; i++){
    paragraphs[i].style.color ="#ffffff";
  }
  var headers = document.evaluate(".//div[@class='main-page']//h1", document, null, XPathResult.ANY_TYPE, null); 
  var theHeader = headers.iterateNext();
  while (theHeader){
    theHeader.style.color ="#ffffff";  
    theHeader = headers.iterateNext();
  }
  var captions = document.getElementsByTagName("figure");
  for(var i = 0; i < captions.length; i++){
    captions[i].style.color ="#ffffff";
  }
  document.getElementById("content").style.backgroundColor ="#000000";
}
function contrast_white_black() {
  var paragraphs = document.getElementsByTagName("p");
  for(var i = 0; i < paragraphs.length; i++){
    paragraphs[i].style.color ="#000000";
  }    
  document.getElementById("content").style.backgroundColor ="#ffffff";
}
function contrast_black_yellow() {
  var paragraphs = document.getElementsByTagName("p");
  for(var i = 0; i < paragraphs.length; i++){
    paragraphs[i].style.color ="yellow";
  }    
  document.getElementById("content").style.backgroundColor ="#000000";
}
function contrast_yellow_black() {
  var paragraphs = document.getElementsByTagName("p");
  for(var i = 0; i < paragraphs.length; i++){
    paragraphs[i].style.color ="#000000";
  }	
  document.getElementById("content").style.backgroundColor ="yellow";
}

function font_change() {
  var font = document.getElementById("text-style").value;
  var x = document.getElementsByClassName("main-page");
  x[0].style.fontFamily = font;
}

function line_spacing() {
  var spacing = document.getElementById("line-space").value;
  var x = document.getElementsByClassName("main-page");
  x[0].style.lineHeight = spacing;
}

function reset() {
  document.getElementById("content").style.color = "#555555";
  document.getElementById("content").style.backgroundColor ="white";
  var x = document.getElementsByClassName("main-page");  
  x[0].style.fontFamily = font;
  x[0].style.lineHeight = "1.42857143";
  document.getElementById("text-style").options[0].selected = 'selected';
  document.getElementById("line-space").value = "1.42857143";
}

</script>

{{#if book}}
  <div class="media-nav{{#is status 'publishing'}} publishing{{/is}}">
    <div class="media-toolbar">
      {{#unless _hideProgress}}
        <button class="toggle contents btn" role="button">
          <span class="fa fa-th-list"></span>
           <span class="text">Contents</span>
           <span class="fa fa-plus open-indicator"></span>
        </button>
        <button class="toggle preferences btn" role="button" onclick="show()">
          <span class="text">Preferences</span>
          <span class="fa fa-plus open-indicator"></span>
        </button>
        
        <div class="searchbar">
          <span class="fa fa-search"></span>
          <input class="find form-control" type="search" placeholder="Search this book" value="{{searchTerm}}" />
        </div>
      {{/unless}}
      <div class="media-navbar">
        <div class="book-nav" aria-busy="true">
          {{#if back}}
            <a class="nav back" href="{{back}}" data-trigger="false">Back</a>
          {{else}}
            <div class="nav back disabled">Back</div>
          {{/if}}

          {{#unless _hideProgress}}
            <div class="progress">
              <div class="secondary progress-bar" style="width: {{percent page pages}}%;"></div>
            </div>
          {{else}}
            <div class="back-to-top">
              <a href="#">Back to Top</a>
            </div>
          {{/unless}}

          {{#if next}}
            <a class="nav next" href="{{next}}" data-trigger="false">Next</a>
          {{else}}
            <div class="nav next disabled">Next</div>
          {{/if}}
        </div>
        
      </div>
      <br>
	<div  id="preferences-options" value="" style="display:none;">

	<div class="preferences-box">
	<b>Contrast</b><br>
	<button id="black-white" class="contrast-option" onclick="contrast_black_white()">a</button>
	<button id="white-black" class="contrast-option" onclick="contrast_white_black()">a</button>	
 	<button id="black-yellow" class="contrast-option" onclick="contrast_black_yellow()">a</button>
	<button id="yellow-black" class="contrast-option" onclick="contrast_yellow_black()">a</button>
	</div>
        
	<div class="preferences-box"  >
	<div class="dropdown">
	  <b>Text Style</b><br>
	  <select id="text-style" onchange="font_change()" >
	    <option value="'Helvetica Neue'">Default</option>
 	    <option value="dyslexie">Dyslexie</option>
	    <option value="Times">Times New Roman</option>
	    <option value="Helvetica">Helvetica</option>
	  </select>
	</div>
        </div>

	<div class="preferences-box"  >
          <b>Keyword Hilighting</b><br>
	  <input type="checkbox" name="highlight" value="Highlight">  Highlight Keywords<br>
        </div>

	<div class="preferences-box"  >
	<div class="dropdown">
  	  <b>Line spacing</b><br><br>
	  <input type="range" id="line-space" name="line-space" onchange="line_spacing()" min="1.2" max="2.7" step=".15" value="1.42857143">        
        </div>
	</div>
        
	
 	<button class="reset-button" onclick="reset()">reset</button>

	</div>

    </div>
  </div>
{{/if}}
